import fs from "fs";
import path from "path";
import { fileURLToPath } from "url";

const __dirname = fileURLToPath(import.meta.url);
const librariesFolder = path.resolve(__dirname, "../../src/libraries");

const outputFileName = "Libraries.sol";

const files = fs.readdirSync(librariesFolder).filter((file) => file.startsWith("Lib"));

const fileList = files.map((file) => {
  if (file == outputFileName) return "";
  return `import { ${file.slice(0, -4)} } from "./${file}";`;
});

const output = `// SPDX-License-Identifier: MIT
pragma solidity >=0.8.0;

/* Autogenerated file. Do not edit manually. */

${fileList.join("\n")}
`;

fs.writeFileSync(path.resolve(librariesFolder, outputFileName), output);
